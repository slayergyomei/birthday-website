<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Memories - Birthday Celebration</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    /* Additional styles for gallery */
    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      padding: 20px 0;
    }
    .gallery-item {
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      background: #fff;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      cursor: pointer;
      outline: none;
    }
    .gallery-item:focus,
    .gallery-item:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 16px rgba(0,0,0,0.2);
    }
    .gallery-item img,
    .gallery-item video {
      width: 100%;
      height: auto;
      display: block;
      border-radius: 10px;
    }
    .gallery-item video {
      background: #000;
    }
    .nav-buttons {
      display: flex;
      justify-content: space-between;
      padding: 20px 0;
    }
      .btn {
      background-color: #007bff;
      border: none;
      color: white;
      padding: 12px 24px;
      font-size: 16px;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.3s ease;
      text-decoration: none;
      text-align: center;
      -webkit-user-select: none;
      user-select: none;
    }
    .btn:hover {
      background-color: #0056b3;
    }
    .next-btn.animate-glow {
      box-shadow: 0 0 8px 2px #00ff99;
      animation: glow 1.5s infinite alternate;
    }
    @keyframes glow {
      from {
        box-shadow: 0 0 8px 2px #00ff99;
      }
      to {
        box-shadow: 0 0 16px 4px #00ff99;
      }
    }
  </style>
</head>
<body>
  <main>
    <section id="section2" class="section gallery-section">
      <h2 class="section-heading animate-in">Some Memorable Moments...</h2>
      <input type="file" id="media-input" accept="image/*,video/*" multiple style="display:none" />
      <div class="gallery-grid animate-in" role="list" id="gallery-grid">
        <!-- Media items will be dynamically loaded here -->
      </div>
      <div class="nav-buttons">
        <button onclick="window.location.href='index.html'" class="btn">Back</button>
        <button onclick="window.location.href='message.html'" class="btn next-btn animate-glow">Next</button>
      </div>
      <button id="add-media-btn" class="btn" aria-label="Add photo or video">Add Photo/Video</button>
    </section>
  </main>
  <script>
    const defaultMediaList = [
      { type: 'image', src: '1.jpg', alt: 'Memorable moment 1' },
      { type: 'image', src: '2.jpg', alt: 'Memorable moment 2' },
      { type: 'image', src: '3.jpg', alt: 'Memorable moment 3' },
      { type: 'video', src: '4.mp4', alt: 'Memorable moment 4' },
      { type: 'video', src: '5.mp4', alt: 'Memorable moment 5' },
      { type: 'video', src: '6.mp4', alt: 'Memorable moment 6' },
      { type: 'video', src: '7.mp4', alt: 'Memorable moment 7' },
      { type: 'image', src: '8.jpg', alt: 'Memorable moment 8' },
      { type: 'image', src: '9.jpg', alt: 'Memorable moment 9' },
      { type: 'image', src: '11.jpg', alt: 'Memorable moment 11' },
      { type: 'video', src: '10.mp4', alt: 'Memorable moment 10' },
      { type: 'video', src: '12.mp4', alt: 'Memorable moment 12' },
      { type: 'video', src: '13.mp4', alt: 'Memorable moment 13' }
    ];

    const galleryGrid = document.getElementById('gallery-grid');

    function getMediaList() {
      const stored = localStorage.getItem('mediaList');
      if (stored) {
        try {
          return JSON.parse(stored);
        } catch {
          return defaultMediaList;
        }
      }
      return defaultMediaList;
    }

    function saveMediaList(list) {
      localStorage.setItem('mediaList', JSON.stringify(list));
    }

    function createGalleryItem(media, index) {
      const div = document.createElement('div');
      div.className = 'gallery-item';
      div.tabIndex = 0;
      div.setAttribute('role', 'listitem');
      div.setAttribute('aria-label', `Memorable moment ${index + 1}`);

      if (media.type === 'image') {
        const img = document.createElement('img');
        img.src = media.src;
        img.alt = media.alt;
        div.appendChild(img);
      } else if (media.type === 'video') {
        const video = document.createElement('video');
        video.controls = true;
        video.preload = 'metadata';
        video.setAttribute('aria-label', media.alt);
        const source = document.createElement('source');
        source.src = media.src;
        source.type = 'video/mp4';
        video.appendChild(source);
        video.innerHTML += 'Your browser does not support the video tag.';
        div.appendChild(video);
      }
      return div;
    }

    function loadGallery() {
      const mediaList = getMediaList();
      galleryGrid.innerHTML = '';
      mediaList.forEach((media, index) => {
        const item = createGalleryItem(media, index);
        galleryGrid.appendChild(item);
      });
    }

    function handleAddMedia(event) {
      const files = Array.from(event.target.files);
      if (files.length === 0) return;

      const mediaList = getMediaList();

      files.forEach(file => {
        const url = URL.createObjectURL(file);
        const type = file.type.startsWith('video') ? 'video' : 'image';
        const alt = file.name;

        mediaList.push({ type, src: url, alt });
      });

      saveMediaList(mediaList);
      loadGallery();
    }

    document.getElementById('media-input').addEventListener('change', handleAddMedia);
    document.getElementById('add-media-btn').addEventListener('click', () => {
      document.getElementById('media-input').click();
    });

    loadGallery();
  </script>
  <script src="effects.js"></script>
  <script src="interactive-background.js"></script>
  <audio id="background-audio" src="song.mp3" autoplay loop controls></audio>
</body>
</html>
